(function(m,n){var l=new function(){var k="trim"in String?"".trim:function(a){return a.replace(/^\s*|\s*$/g,"")},l={filterRegex:function(a){a=a.replace(/x0020_/g,"");return h.regex?a.replace(h.regex,h.regexReplacement):a},isXML:function(a){return"object"===typeof a&&a.nodeType!==n},getRoot:function(a){return 9===a.nodeType?a.documentElement:11===a.nodeType?a.firstChild:a},convert:function(a){var b={};if("string"===typeof a){var c=null,d=null,e=!0;try{c="DOMParser"in m?new DOMParser:new ActiveXObject("MSXML2.DOMDocument"),
c.async=!1}catch(f){throw Error("XML Parser could not be instantiated");}"parseFromString"in c?(d=c.parseFromString(a,"text/xml"),e="parsererror"!==d.documentElement.tagName):d=(e=c.loadXML(a))?c:!1;if(!e)throw Error("Error parsing XML string");a=d}else a=this.isXML(a)?a:n;if(!a)throw Error("Unable to parse XML");if(3===a.nodeType||4===a.nodeType)return a.nodeValue;a=this.getRoot(a);b[a.nodeName]={};this.process(a,b[a.nodeName]);return b},process:function(a,b){var c,d,e,f,g;if(a.hasChildNodes())for(f=
a.childNodes.length,e=0;e<f;e++)switch(c=a.childNodes[e],c.nodeType){case 3:b.Text=b.Text?b.Text+k(c.nodeValue):k(c.nodeValue);break;case 4:c=c[c.text?"text":"nodeValue"];b.Text=b.Text?b.Text+c:c;break;case 1:d=c.nodeName,g={},d in b?b[d].length?(this.process(c,g),b[d].push(g)):(this.process(c,g),b[d]=[b[d],g]):(this.process(c,g),b[d]=g)}if(a.attributes.length){for(f=a.attributes.length-1;0<=f;f--)c=a.attributes[f],e=k(c.name),c=c.value,b[this.filterRegex(e)]=c;b.Id&&(b.numericId=+b.Id)}}},h=this;
this.regex=null;this.regexReplacement="";this.retFn=function(a,b){h.regex="undefined"!==typeof b&&b.regex?b.regex:null;h.regexReplacement="undefined"!==typeof b&&b.regexReplacement?b.regexReplacement:"";return l.convert(a)}};m.xml=l.retFn})(window);